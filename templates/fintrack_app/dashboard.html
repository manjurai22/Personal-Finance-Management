{% extends 'fintrack_app/base.html' %}

{% block content %}

<!-- USER INFO -->
<div class="user-header">
    <h4>Hello, {{ profile.user.username }} ðŸ‘‹</h4>
</div>

<!-- TOP STATS + GRAPH -->
<div class="row g-4">

    <!-- LEFT STATS -->
    <div class="col-md-4">
        <div class="stat-card balance">
            <p>Total Balance</p>
            <h2>Rs. {{ balance }}</h2>
        </div>

        <div class="stat-card income">
            <p>Total Income</p>
            <h3>Rs. {{ income }}</h3>
        </div>

        <div class="stat-card expense">
            <p>Total Expense</p>
            <h3>Rs. {{ expense }}</h3>
        </div>
    </div>

    <!-- RIGHT GRAPH -->
    <div class="col-md-8">
        <div class="card chart-box">
            <h5>Income vs Expense</h5>
            <canvas
                id="incomeExpenseChart"
                data-income="{{ income }}"
                data-expense="{{ expense }}"
                ></canvas>

        </div>
    </div>

</div>

<!-- TRANSACTIONS + MONTHLY BAR GRAPH -->
<div class="row g-4 mt-4">

    <!-- TRANSACTIONS -->
    <div class="col-md-6">
        <div class="card table-card">
            <h5>Recent Transactions</h5>

            <table class="table align-middle">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Category</th>
                        <th>Amount</th>
                    </tr>
                </thead>
                <tbody>
                {% for tx in transactions %}
                    <tr>
                        <td>{{ tx.date }}</td>
                        <td>{{ tx.category.name }}</td>
                        <td class="{% if tx.transaction_type == 'expense' %}text-danger{% else %}text-success{% endif %}">
                            Rs. {{ tx.amount }}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

        </div>
    </div>

    <!-- MONTHLY EXPENSE BAR -->
    <div class="col-md-6">
        <div class="card chart-box">
            <h5>Expense by Category</h5>
            <canvas
            id="monthlyExpenseChart"
            data-labels='{{ monthly_labels|safe }}'
            data-values='{{ monthly_totals|safe }}'
            ></canvas>

        </div>
    </div>

</div>

{% endblock %}
